"use strict";(function(){var a;a=function(b,d,c){b.delay=250;b.classname={ready:"ready"};b.nameAttr="data-name";b.defer=function(f,e){e=e||b.delay;return setTimeout(function(){f();
},e);};b.$on("refresh",function(){$.each(c,function(f,e){var g=$("."+e.getAttribute("data-destserv-class"),e);$.each(g,function(i,k){var h=k.getAttribute(b.nameAttr);
b[h].layer.refresh();});});});b.$on("submit",function(){$.each(c,function(f,e){var g=$("."+e.getAttribute("data-destserv-class"),e);$.each(g,function(i,k){var h=k.getAttribute(b.nameAttr);
});});});b.onready=function(e,f){b[e]={target:f,form:{placeholder:f.getAttribute("data-placeholder"),input:document.forms[f.getAttribute("data-input-form")][f.getAttribute("data-input-name")],update:function(g){b[e].form.value=g;
b[e].form.input.value=g;},submit:function(){var h,m,k,l;l=b[e].form.input.form;h=navigator.geolocation;m=$(".errors",l)[0];m.innerHTML="";k=false;$(m.parentNode.parentNode).removeClass("errorEndDate");
$(m.parentNode.parentNode).removeClass("errorLocation");$(m.parentNode.parentNode).removeClass("hasErrors");if(l.location.value.length<3){m.innerHTML+="<p>Minimum 3 characters required to perform successful search.</p>";
$(m).addClass("hasThem");k=true;$(m.parentNode.parentNode).addClass("errorLocation");}if(new Date(l.endDate.value)<=new Date(l.startDate.value)){m.innerHTML+="<p>Check-out date is not valid. The check-out date must be after the check-in date.</p>";
$(m).addClass("hasThem");k=true;$(m.parentNode.parentNode).addClass("errorEndDate");}if(k){$(m.parentNode.parentNode).addClass("hasErrors");b.$emit("refresh");
document.activeElement.blur();return false;}if(h){var i=l,g=b[e].form.input,j=g.value.indexOf(i.getAttribute("data-location-key"))!=-1;if(j){navigator.geolocation.getCurrentPosition(function(n){var o=[n.coords.latitude,n.coords.longitude];
g.value=o;g.form.submit();},function(n){var o="";switch(n.code){case n.PERMISSION_DENIED:o="User denied the request for Geolocation.";break;case n.POSITION_UNAVAILABLE:o="Location information is unavailable.";
break;case n.TIMEOUT:o="The request to get user location timed out.";break;case n.UNKNOWN_ERROR:o="An unknown error occurred.";break;}alert(o);});}else{g.form.submit();
}}b.$emit("refresh");}},layer:{search:{term:"",stub:"",filter:"",placeholder:f.getAttribute("data-placeholder-layer"),url:"",urlCached:"",hasTerm:false,hasStub:false,hasFilter:false,hasResults:false,results:{raw:[],cached:[],filtered:[],capped:[]},timeout:null},copy:{cancel:f.getAttribute("data-copy-cancel")},form:document.forms[f.getAttribute("data-layer-form")],state:"off",position:function(g){var i,h;
h=$(".field.location",b[e].target);i=h.position().top;if(g==="off"){b.defer(function(){b[e].layer.form.style.top=i+"px";},1);}else{b.defer(function(){b[e].layer.form.style.top=0;
window.scrollTo(0,0);},1);}},refresh:function(g){if(g){b[e].layer.state=g;b[e].layer.position(g);}else{if(b[e].layer.state==="off"){b[e].layer.position("off");
}else{b[e].layer.position("on");}}},doFilter:function(){b[e].layer.search.hasResults=b[e].layer.search.results.raw.length>0;if(b[e].layer.search.hasResults){b[e].layer.search.results.filtered=_.filter(b[e].layer.search.results.raw,function(g){return g.v.toLowerCase().indexOf(b[e].layer.search.filter.toLowerCase())!=-1;
});b[e].layer.search.results.capped=_.first(b[e].layer.search.results.filtered,10);}},submit:function(g){document.activeElement.blur();b[e].layer.state="off";
b[e].form.update(b[e].layer.search.term);b.$emit("refresh");b[e].layer.scroll();},doSearch:function(g){clearTimeout(b[e].layer.search.timeout);if(b[e].layer.search.url!==b[e].layer.search.urlCached){b[e].layer.search.timeout=b.defer(function(){d.get(g).success(function(h){b[e].layer.search.results.raw=h;
b[e].layer.search.urlCached=g;b[e].layer.search.results.cached=h;});});}else{b[e].layer.search.results.raw=b[e].layer.search.results.cached;}},doClear:function(){clearTimeout(b[e].layer.search.timeout);
b[e].layer.search.filter="";b[e].layer.search.results.raw=[];b[e].layer.search.results.filtered=[];b[e].layer.search.results.capped=[];},clickHeader:function(h){var g=(b[e].layer.state==="off")?"show":h.target.getAttribute("data-ui");
switch(g){case"cancel":b[e].layer.dismiss(h);break;case"clear":b[e].layer.clear(h);break;case"show":b[e].layer.show(h);}h.preventDefault();h.stopPropagation();
},clickLayer:function(i){var h=i.target.getAttribute("data-ui"),j=i.target.getAttribute("data-value"),g=(h==="location"||h==="city")?"suggestion":"void";
switch(g){case"suggestion":b[e].form.update(j);b[e].layer.dismiss(i);break;default:document.activeElement.blur();}i.preventDefault();i.stopPropagation();
},clear:function(g){b[e].layer.form.field.focus();b[e].layer.form.field.value="";b[e].layer.doClear();g.preventDefault();g.stopPropagation();},dismiss:function(g){g.preventDefault();
g.stopPropagation();b[e].layer.refresh("off");b[e].layer.scroll();},show:function(g){b[e].layer.form.field.focus();g.preventDefault();g.stopPropagation();
b[e].layer.refresh("on");},scroll:function(){$("html, body").animate({scrollTop:$(b[e].target).offset().top},b.delay);}}};b[e].form.update(f.getAttribute("data-value"));
b[e].form.update(b[e].form.value||b[e].form.placeholder);$(f).addClass(b.classname.ready);b.defer(function(){b[e].layer.refresh();});b.$watch(e+".layer.search.term",function(){b[e].layer.search.hasTerm=b[e].layer.search.term!==null&&b[e].layer.search.term!=="";
if(b[e].layer.search.hasTerm){b[e].layer.search.hasStub=b[e].layer.search.term.length>2;if(b[e].layer.search.hasStub){b[e].layer.search.stub=b[e].layer.search.term.substring(0,3);
b[e].layer.search.hasFilter=b[e].layer.search.term.length>3;if(b[e].layer.search.hasFilter){b[e].layer.search.filter=b[e].layer.search.term;}}else{b[e].layer.search.stub="";
}}},true);b.$watch(e+".layer.search.stub",function(){if(b[e].layer.search.stub===""){b[e].layer.search.url="";}else{b[e].layer.search.url="json/"+b[e].layer.search.stub.toLowerCase()+".json";
}},true);b.$watch(e+".layer.search.filter",function(){b[e].layer.doFilter();},true);b.$watch(e+".layer.search.url",function(){if(b[e].layer.search.url!==""){b[e].layer.doSearch(b[e].layer.search.url);
}else{b[e].layer.doClear();}},true);b.$watch(e+".layer.search.results.raw",function(){b[e].layer.doFilter();},true);};$.each(c,function(f,e){var g=$("."+e.getAttribute("data-destserv-class"),e);
$.each(g,function(i,k){var h=k.getAttribute(b.nameAttr);b.onready(h,k);});});};a.$inject=["$scope","$http","$rootElement"];window.DestServCtrl=a;}());